PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX genosisOwl: <http://example.org/genosis.owl#>
# Tambahkan prefix OSN jika Anda ingin menggunakannya untuk tipe spesifik
# PREFIX OSN: <http://saralutami.org/OnlineSocialNetworkSites#> 
# (Namun, berdasarkan definisi kelas di GENOSIS, Anda akan menggunakan genosisOwl:OSN:DirectMessage)

SELECT ?suspectUser ?suspectLabel ?activityType ?detail ?platform ?timestamp
WHERE {
  ?suspectUser rdfs:label ?suspectLabel .
  {
    # Kondisi Hanya untuk OSN DM
    ?message rdf:type genosisOwl:OSN:DirectMessage ; # Lebih spesifik ke OSN:DirectMessage
             genosisOwl:attributedToUser ?suspectUser ; 
             genosisOwl:hasMessageContent ?msgText ;
             genosisOwl:hasMessageSentTimestamp ?timestamp ; 
             genosisOwl:belongsToPlatform ?platform .
    # Pastikan platform adalah Facebook atau Instagram jika perlu
    FILTER (?platform = "Facebook" || ?platform = "Instagram") 
    FILTER regex(str(?msgText), "end it|ruin your life|watch your back|just disappear|leak private|I will scam you|you fell for it|stupid buyer|say goodbye to your money|regret it|handle nosy people|worry about your own privacy|threat|expose|deserves what's coming|cc dumps|stolen data|monero|untraceable payment|shut up|get lost|illegal|report all you want", "i")
    BIND("Sent Suspicious OSN DM" AS ?activityType)
    BIND(STR(?msgText) AS ?detail)
  }
}
ORDER BY DESC(?timestamp) ?suspectLabel