PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX ex: <http://www.w3.org/2002/07/owl#>  # Sesuaikan dengan XML namespace Anda
SELECT ?userA ?platformA ?userB ?platformB ?commonField ?fieldValue
WHERE {
  ?userA rdf:type ex:User ;
         ex:belongsToPlatform ?platformA .
  ?userB rdf:type ex:User ;
         ex:belongsToPlatform ?platformB .

  FILTER(?userA != ?userB)
  FILTER(?platformA != ?platformB)

  # 1) MATCH BASED ON EMAIL
  {
    ?userA ex:hasEmail ?fieldValue .
    ?userB ex:hasEmail ?fieldValue .
    BIND("email" AS ?commonField)
  }
  UNION
  # 2) MATCH BASED ON PHONE
  {
    ?userA ex:hasPhoneNumber ?fieldValue .
    ?userB ex:hasPhoneNumber ?fieldValue .
    BIND("phone" AS ?commonField)
  }
  UNION
  # 3) MATCH BASED ON USERNAME
  {
    ?userA ex:hasUsername ?fieldValue .
    ?userB ex:hasUsername ?fieldValue .
    BIND("username" AS ?commonField)
  }
  UNION
  # 4) MATCH BASED ON PASSWORD HASH (Jika tersedia)
  {
    ?userA ex:hasPasswordHash ?fieldValue .
    ?userB ex:hasPasswordHash ?fieldValue .
    BIND("passwordHash" AS ?commonField)
  }
}
ORDER BY ?userA ?userB ?commonField