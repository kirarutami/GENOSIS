PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX owl: <http://www.w3.org/2002/07/owl#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
PREFIX ex: <http://www.w3.org/2002/07/owl#>

SELECT DISTINCT ?user1 ?user2 ?sharedDM ?platform
WHERE {
  # Pengguna 1 dan Pengguna 2 yang saling mengirim pesan DM
  ?dm1 rdf:type ex:DirectMessages ;
       ex:dmSender ?user1 ;
       ex:dmReceiver ?user2 ;
       ex:hasDMContent ?sharedDM ;
       ex:belongsToPlatform ?platform .

  ?dm2 rdf:type ex:DirectMessages ;
       ex:dmSender ?user2 ;
       ex:dmReceiver ?user1 ;
       ex:hasDMContent ?content2 ;
       ex:belongsToPlatform ?platform .

  FILTER (?user1 != ?user2)

  # Menggunakan REGEX untuk mencari DM yang mengandung kata 'collaborate' atau 'coordinate'
  FILTER (
    REGEX(?content1, "collaborate", "i") ||
    REGEX(?content1, "coordinate", "i") ||
    REGEX(?content2, "stole", "i") 
  )
}
ORDER BY ?user1 ?user2